<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Undertale Battle - 3 Vidas</title>

<style>
  body {
    background-color: black;
    color: white;
    font-family: 'Courier New', monospace;
    text-align: center;
    overflow: hidden;
  }
  #battle-box {
    border: 4px solid white;
    width: 400px;
    height: 250px;
    margin: 50px auto;
    position: relative;
    overflow: hidden;
  }
  #soul {
    width: 16px;
    height: 16px;
    background-color: red;
    position: absolute;
    bottom: 10px;
    left: 190px;
    border-radius: 3px;
    transition: background-color 0.2s;
  }
  .bullet {
    width: 10px;
    height: 10px;
    background-color: white;
    position: absolute;
    border-radius: 50%;
  }
  #text-box {
    border: 2px solid white;
    width: 400px;
    margin: 20px auto;
    padding: 10px;
    height: 60px;
  }
  #lives {
    margin-top: 10px;
  }
  .heart {
    display: inline-block;
    width: 14px;
    height: 14px;
    background-color: red;
    margin: 2px;
    transform: rotate(45deg);
  }
  .heart::before, .heart::after {
    content: "";
    width: 14px;
    height: 14px;
    background-color: red;
    border-radius: 50%;
    position: absolute;
  }
  .heart::before {
    left: -7px;
  }
  .heart::after {
    top: -7px;
  }
</style>
</head>
<body>
  <h1>UNDERTALE (HTML DEMO)</h1>
  <div id="battle-box">
    <div id="soul"></div>
  </div>
  <div id="text-box">Desvie dos ataques!</div>
  <div id="lives"></div>

  <script>
    const battleBox = document.getElementById('battle-box');
    const soul = document.getElementById('soul');
    const textBox = document.getElementById('text-box');
    const livesDiv = document.getElementById('lives');
    let x = 190, y = 220;
    const speed = 4;

    const bullets = [];
    const bulletSpeed = 2;
    let lives = 3;
    let invulnerable = false;
    let gameOver = false;

    // Mostrar vidas na tela
    function renderLives() {
      livesDiv.innerHTML = '';
      for (let i = 0; i < lives; i++) {
        const heart = document.createElement('div');
        heart.classList.add('heart');
        livesDiv.appendChild(heart);
      }
    }
    renderLives();

    // Movimento do SOUL
    document.addEventListener('keydown', (e) => {
      if (gameOver) return;
      if (e.key === 'ArrowLeft') x -= speed;
      if (e.key === 'ArrowRight') x += speed;
      if (e.key === 'ArrowUp') y -= speed;
      if (e.key === 'ArrowDown') y += speed;

      // Limites
      x = Math.max(0, Math.min(x, 384));
      y = Math.max(0, Math.min(y, 234));

      soul.style.left = x + 'px';
      soul.style.top = y + 'px';
    });

    // Criar proj√©teis
    function spawnBullet() {
      if (gameOver) return;
      const bullet = document.createElement('div');
      bullet.classList.add('bullet');
      bullet.style.left = Math.random() * 390 + 'px';
      bullet.style.top = '0px';
      battleBox.appendChild(bullet);
      bullets.push({ el: bullet, x: parseFloat(bullet.style.left), y: 0 });
    }

    // Atualizar proj√©teis
    function updateBullets() {
      bullets.forEach((b) => {
        b.y += bulletSpeed;
        b.el.style.top = b.y + 'px';

        // Colis√£o
        const dx = (x + 8) - (b.x + 5);
        const dy = (y + 8) - (b.y + 5);
        if (Math.sqrt(dx * dx + dy * dy) < 12 && !invulnerable && !gameOver) {
          takeDamage();
        }

        if (b.y > 260) b.el.remove();
      });
    }

    // Dano
    function takeDamage() {
      lives--;
      renderLives();
      invulnerable = true;
      soul.style.backgroundColor = 'gray';
      textBox.textContent = `Voc√™ foi atingido! Vidas restantes: ${lives}`;
      setTimeout(() => {
        soul.style.backgroundColor = 'red';
        invulnerable = false;
        if (!gameOver) textBox.textContent = 'Desvie dos ataques!';
      }, 1200);

      if (lives <= 0) {
        gameOver = true;
        textBox.textContent = 'üíÄ GAME OVER üíÄ';
        soul.style.backgroundColor = 'black';
      }
    }

    // Loop principal
    function gameLoop() {
      if (!gameOver) updateBullets();
      requestAnimationFrame(gameLoop);
    }

    setInterval(spawnBullet, 600);
    gameLoop();
  </script>
</body>
</html>
